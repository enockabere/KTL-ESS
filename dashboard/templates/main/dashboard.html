{% extends 'offcanvas.html' %}
{% block title %}
DASHBOARD
{% endblock %}

{% block head %}
<link rel="stylesheet" href="../../../static/css/profile.css" />
<script src="../../../static/css/boot/js/vendor.bundle.base.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
{% endblock %}
{% block main %}
<section>
    <div class="content-wrapper general-bg">
        {% include 'alerts.html' %}
        {% include 'main/top-stats.html' %}
        <div class="row g-1 mt-2">
            <div class="col-md-7 mb-2">
                <div class="card summ-cards stat_card_one h-100">
                    <div class="card-title">
                        Human Resource Summary
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <canvas id="Chart2"></canvas>
                                <script>
                                    const newlabel = [
                                        'Leave',
                                        'Training',
                                    ];

                                    var pending_Leave = '{{pendLeave}}'
                                    var pending_training = '{{pendTrain}}'
                                    const data2 = {
                                        labels: newlabel,
                                        datasets: [{
                                            label: 'Requests Pending Approval',
                                            backgroundColor: [
                                                '#ff5e6c',
                                                '#DFFF00',
                                            ],
                                            data: [pending_Leave, pending_training],
                                            hoverOffset: 4,
                                        }]
                                    };

                                    const configs = {
                                        type: 'pie',
                                        data: data2,
                                        options: {
                                            radius: '70%',
                                        }
                                    };
                                </script>
                                <script>
                                    const Chart2 = new Chart(
                                        document.getElementById('Chart2'),
                                        configs
                                    );
                                </script>
                            </div>
                            <div class="col-md-6">
                                <div class="c-content-top">
                                    <h5>Approved Requests</h5>
                                </div>
                                <h6><img src="../../../static/icons/record.png" height="15" width="15" class="img-fluid"
                                        alt="" srcset=""> Leave
                                    Requests <span class="text-primary">({{approved_leave}})</span>
                                </h6>
                                <h6 class="my-2"><img src="../../../static/icons/record.png" height="15" width="15"
                                        class="img-fluid" alt="" srcset=""> Training Requests
                                    <span class="text-primary">({{app_train}})</span></h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-5">
                <div class="card text-white card-has-bg click-col stat_card_one"
                    style="background-image:url('https://source.unsplash.com/600x900/?nature,farm');">
                    <img class="card-img d-none" src="https://source.unsplash.com/600x900/?nature,farm"
                        alt="Goverment Lorem Ipsum Sit Amet Consectetur dipisi?">
                    <div class="card-img-overlay d-flex flex-column">
                        <div class="card-body">
                            <small class="card-meta mb-2">Poll of the week</small>
                            <h4 class="card-title mt-1 ">
                                <span>What is your mobile app usage daily?</span></h4>
                            <form action="">
                                <div class="row mb-1">
                                    <div class="col-md-12">
                                        <input class="form-check-input" type="radio" name="flexRadioDefault">
                                        <label class="form-check-label mt-1">
                                            A 30 Minutes
                                        </label>
                                    </div>
                                </div>
                                <div class="row mb-1">
                                    <div class="col-md-12">
                                        <input class="form-check-input" type="radio" name="flexRadioDefault">
                                        <label class="form-check-label mt-1">
                                            B More than 30 minutes
                                        </label>
                                    </div>
                                </div>
                                <div class="row mb-1">
                                    <div class="col-md-12">
                                        <input class="form-check-input" type="radio" name="flexRadioDefault">
                                        <label class="form-check-label mt-1">
                                            C 1 Hour
                                        </label>
                                    </div>
                                </div>
                                <div class="row mb-2">
                                    <div class="col-md-12">
                                        <input class="form-check-input" type="radio" name="flexRadioDefault">
                                        <label class="form-check-label mt-1 mb-2">
                                            D More than 1 hour
                                        </label>

                                    </div>
                                </div>
                                <div class="row mb-2">
                                    <div class="col-md-12">
                                        <button class="btn button-86" type="submit">Submit </button>
                                    </div>
                                </div>
                            </form>
                            <small><i class="far fa-clock"></i> {{today}} <span id="timer"></span></small>
                        </div>
                        <div class="card-footer">
                            <div class="media">
                                <img class="mr-3 rounded-circle" src="../../../static/img/logo/pp.png"
                                    alt="Generic placeholder image" style="max-width:50px">
                                <div class="media-body">
                                    <h6 class="my-0 text-white d-block">{{full_name}}</h6>
                                    {% if department_name %}
                                    <small>
                                        {{department_name}}
                                    </small>
                                    {% else %}
                                    <small>
                                        Department Name Missing
                                    </small>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row g-1">
            <div class="col-md-6 mb-2">
                <div class="card summ-cards h-100">
                    <div class="card-title">
                        FIles
                    </div>
                    <div class="row p-3 gx-1">
                        <div class="col-md-6 mb-5">
                            <div class="card pb-4 document_card h-100">
                                <div class="document_top_icon mt-3">
                                    <img src="../../../static/icons/file_download.png" height="50" width="50"
                                        class="img-fluid" alt="" srcset="">
                                </div>
                                <p class="h4 pt-4">P9 Form</p>
                                <p class="p1 text-muted">
                                    Download P9 from recently closed payroll period(<span class="brs"
                                        id="starting_date_card">{{payroll_period.Starting_Date}}</span>).
                                </p>
                                <script>
                                    $(document).ready(function () {
                                        $("#starting_date_card")
                                            .empty().append(moment(
                                                    '{{payroll_period.Starting_Date}}', "YYYY-MM-DD")
                                                .format(
                                                    'Do MMM YYYY'));
                                    });
                                </script>
                                <form action="{% url 'pNine' %}" method="POST">
                                    {% csrf_token %}
                                    <input type="hidden" name="startDate" value="{{payroll_period.Starting_Date}}">
                                    <button class="btn download_submit" type="submit"><span
                                            class="fa fa-download"></span></button>
                                </form>
                            </div>
                        </div>
                        <div class="col-md-6 mb-5">
                            <div class="card pb-4 document_card h-100">
                                <div class="document_top_icon mt-3">
                                    <img src="../../../static/icons/file_download.png" height="50" width="50"
                                        class="img-fluid" alt="" srcset="">
                                </div>
                                <p class="h4 pt-4">Payslip</p>
                                <p class="p1 text-muted">
                                    Download payslip for (<span class="brs">{{payroll_period.Starting_Date|slice:"4" }}
                                        - {{payroll_period.Name}}</span>).
                                </p>
                                <form action="{% url 'payslip' %}" method="POST">
                                    {% csrf_token %}
                                    <input type="hidden" name="paymentPeriod" value="{{payroll_period.Starting_Date}}">
                                    <button class="btn download_submit" type="submit"><span
                                            class="fa fa-download"></span></button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-2">
                <div class="card summ-cards h-100">
                    <div class="card-title">
                        Finance Summary
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <canvas id="myChart"></canvas>
                                <script>
                                    const labels = [
                                        'Imprest Requisition',
                                        'Imprest Surrender',
                                        'Staff Claim',
                                        'Salary Advance',
                                    ];
                                    var pending_imprest = '{{pending_imprest}}'
                                    var pending_surrender = '{{pending_surrender}}'
                                    var pending_claims = '{{pending_claims}}'
                                    var Pending_advances = '{{Pending_advances}}'
                                    const data = {
                                        labels: labels,
                                        datasets: [{
                                            label: 'Requests Pending Approval',
                                            backgroundColor: [
                                                '#144a85',
                                                '#25cc88',
                                                '#e1b382',
                                                '#DFFF00',
                                            ],
                                            data: [pending_imprest, pending_surrender, pending_claims,
                                                Pending_advances,
                                            ],
                                        }]
                                    };

                                    const config = {
                                        type: 'doughnut',
                                        data: data,
                                        options: {

                                        }
                                    };
                                </script>
                                <script>
                                    const myChart = new Chart(
                                        document.getElementById('myChart'),
                                        config
                                    );
                                </script>
                            </div>
                            <div class="col-md-6">
                                <div class="c-content-top">
                                    <h5>Approved Requests</h5>
                                </div>
                                <h6><img src="../../../static/icons/record.png" height="15" width="15" class="img-fluid"
                                        alt="" srcset=""> Imprest Requisitions
                                    <span class="text-info">({{imprest_app}})</span></h6>
                                <h6 class="my-2"><img src="../../../static/icons/record.png" height="15" width="15"
                                        class="img-fluid" alt="" srcset=""> Imprest Surrenders
                                    <span class="text-info">({{surrender_app}})</span></h6>
                                <h6 class="my-2"><img src="../../../static/icons/record.png" height="15" width="15"
                                        class="img-fluid" alt="" srcset=""> Staff Claims
                                    <span class="text-info">({{app_claim}})</span></h6>
                                <h6 class="my-2"><img src="../../../static/icons/record.png" height="15" width="15"
                                        class="img-fluid" alt="" srcset=""> Salary Advances
                                    <span class="text-info">({{approved_advances}})</span></h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row pb-3">
            <div class="col-md-12">
                <div class="card summ-cards">
                    <div class="card-title">
                        Procurement Summary
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <canvas id="Chart3"></canvas>
                                <script>
                                    const procurement_label = [
                                        'Purchase Requisition',
                                        'Repair and Maintenance',
                                        'Store Requisition',
                                        'General Requisition',
                                    ];

                                    var pending_purchase = '{{pending_purchase}}'
                                    var pending_repair = '{{pending_repair}}'
                                    var pending_store = '{{pending_store}}'
                                    var pending_general = '{{pending_general}}'
                                    const procurement_data = {
                                        labels: procurement_label,
                                        datasets: [{
                                            label: 'Requests Pending Approval',
                                            backgroundColor: [
                                                '#ff5e6c',
                                                '#DFFF00',
                                                '#144a85',
                                                '#25cc88',
                                            ],
                                            data: [pending_purchase, pending_repair, pending_store,
                                                pending_general
                                            ],
                                            hoverOffset: 4,
                                        }]
                                    };

                                    const conf = {
                                        type: 'pie',
                                        data: procurement_data,
                                        options: {
                                            radius: '50%'
                                        }
                                    };
                                </script>
                                <script>
                                    const Chart3 = new Chart(
                                        document.getElementById('Chart3'),
                                        conf
                                    );
                                </script>
                            </div>
                            <div class="col-md-6">
                                <div class="c-content-top">
                                    <h5>Approved Requests</h5>
                                </div>
                                <h6><img src="../../../static/icons/record.png" height="15" width="15" class="img-fluid"
                                        alt="" srcset=""> Purchase Requisitions
                                    <span class="text-success">({{app_purchase}})</span></h6>
                                <h6 class="my-2"><img src="../../../static/icons/record.png" height="15" width="15"
                                        class="img-fluid" alt="" srcset=""> Repair & Maintenance
                                    <span class="text-success">({{app_repair}})</span></h6>
                                <h6 class="my-2"><img src="../../../static/icons/record.png" height="15" width="15"
                                        class="img-fluid" alt="" srcset=""> Store Requisitions
                                    <span class="text-success">({{app_store}})</span></h6>
                                <h6 class="my-2"><img src="../../../static/icons/record.png" height="15" width="15"
                                        class="img-fluid" alt="" srcset=""> GeneralRequisitions
                                    <span class="text-success">({{approved_general}})</span></h6>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



{% endblock %}